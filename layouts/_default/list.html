{{ define "main" }}             <!-- List of all posts -->

{{ with .GitInfo }} <!-- To enable this, put "enableGitInfo = true" in your site config.toml -->
    This page was created/modified in commit <a href="{{ $.Site.Params.source.url }}/commit/{{- .Hash -}}">
    {{- .AbbreviatedHash -}}</a> "{{ .Subject }}" on <b>{{ dateFormat "2006-01-02" .AuthorDate }}</b>.
{{ end }}
{{ with .File.Path }}
    <div>
        <br/>
        <span style="float: right;">✱ <i>Markdown <a href="{{ $.Site.Params.source.url }}/raw/master/{{ $.Site.Params.source.md_dir }}/{{ . }}">source</a> of this page</i></span>
        <br/>
    </div>
{{ end }}

{{ if (and (eq .Kind "section") (ne .File.Path "")) }} <!-- Branch bundle based section -->
    <h1>{{ .Title }}</h1>
    <h2>Posts in ‘{{ .Dir | default .Section }}’</h2>
{{ else if (and (eq .Kind "section") (eq .File.Path "")) }} <!-- Regular section -->
    <h1>Posts in ‘{{ .Dir | default .Section }}’</h1>
{{ else if (eq .Kind "taxonomy") }}
    <h1>Posts with the {{ .Type | singularize }} ‘{{ .URL | replaceRE (printf "/%s/" .Type) "" | replaceRE "/" "" }}’</h1>
{{ end }}

<section>
    <ul class="post-list">
        {{ range .Pages }}
            {{ .Render "li" }}
        {{ end }}
    </ul>
</section>

{{ with .Content }}
    <hr>
    {{ . }}
{{ end }}

{{ with .Resources }}
    <hr>
    <h3>Resources</h3>
    <ul>
	{{ range . }}
	    {{ if .RelPermalink }}
	        <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
	    {{ else }}
	        <li>{{ .ResourceType | title }} (no link, only embedded in page)</li>
	    {{ end }}
	{{ end }}
    </ul>
{{ end }}

<hr>
<a id="debug"></a>
<h3 id="page-debug">Page (Debug)</h3>
{{ partial "debugprint.html" . }}
<h3 id="page-params-debug">Page Params (Debug)</h3>
{{ partial "debugprint.html" .Params }}
{{ with .Resources }}
    <h3 id="resource-debug">Resources (Debug)</h3>
    {{ partial "debugprint.html" . }}
{{ end }}
<h3 id="file-debug">File Object (Debug)</h3>
{{ partial "debugprint.html" .File }}

{{ end }}
